From 882c396572276f8de8288d0479c905894ca5cb90 Mon Sep 17 00:00:00 2001
From: Hongze Zhang <hongze.zhang@intel.com>
Date: Sat, 22 Feb 2025 16:44:11 +0800
Subject: [PATCH] fix: Change FetchContent name of `gtest` to `googletest` as
 `gtest_SOURCE_DIR` is used internally by googletest

---
 CMake/resolve_dependency_modules/gtest.cmake | 4 ++--
 CMakeLists.txt                               | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/CMake/resolve_dependency_modules/gtest.cmake b/CMake/resolve_dependency_modules/gtest.cmake
index bfbac66d9..f1c892bb4 100644
--- a/CMake/resolve_dependency_modules/gtest.cmake
+++ b/CMake/resolve_dependency_modules/gtest.cmake
@@ -24,12 +24,12 @@ velox_resolve_dependency_url(GTEST)

 message(STATUS "Building gtest from source")
 FetchContent_Declare(
-  gtest
+  googletest
   URL ${VELOX_GTEST_SOURCE_URL}
   URL_HASH ${VELOX_GTEST_BUILD_SHA256_CHECKSUM}
   OVERRIDE_FIND_PACKAGE SYSTEM EXCLUDE_FROM_ALL)

-FetchContent_MakeAvailable(gtest)
+FetchContent_MakeAvailable(googletest)

 # Mask compilation warning in clang 16.
 target_compile_options(gtest PRIVATE -Wno-implicit-int-float-conversion)
diff --git a/CMakeLists.txt b/CMakeLists.txt
index 339d1ed0d..eb781253f 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -594,7 +594,7 @@ if(NOT VELOX_DISABLE_GOOGLETEST)
   velox_set_source(GTest)
   velox_resolve_dependency(GTest)
   set(VELOX_GTEST_INCUDE_DIR
-      "${gtest_SOURCE_DIR}/googletest/include"
+      "${gtest_SOURCE_DIR}/include"
       PARENT_SCOPE)
 endif()

-- 
2.25.1

